<!-- gamesarc/login.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - GamesArc</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="auth.css"> <!-- Add this line -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header - Update this with auth integration -->
    <header class="header">
        <a href="index.html" class="logo">
            <i class="fas fa-gamepad"></i> GamesArc
        </a>
        
        <nav class="nav-links">
            <a href="index.html" class="nav-link">
                <i class="fas fa-home"></i> Home
            </a>
            <a href="games.html" class="nav-link">
                <i class="fas fa-gamepad"></i> Games
            </a>
            <a href="membership.html" class="nav-link">
                <i class="fas fa-crown"></i> Membership
            </a>
            <a href="contact.html" class="nav-link">
                <i class="fas fa-envelope"></i> Contact
            </a>
        </nav>
        
        <!-- Add this auth section -->
        <div class="nav-auth">
            <a href="login.html" id="loginBtn" class="nav-link" style="display: none;">
                <i class="fas fa-sign-in-alt"></i> Login
            </a>
            <div class="user-menu" id="profileBtn" style="display: none;">
                <a href="profile.html" class="nav-link">
                    <i class="fas fa-user"></i> Profile
                </a>
                <div class="dropdown-content" id="userMenu">
                    <!-- Will be populated by auth.js -->
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="form-container">
            <h2 style="text-align: center; font-family: 'Orbitron', sans-serif; margin-bottom: 2rem;">
                <i class="fas fa-user"></i> Welcome Back
            </h2>
            
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <input type="email" 
                           id="loginEmail"
                           placeholder="Email" 
                           class="form-input" 
                           required>
                </div>
                
                <div class="form-group">
                    <input type="password" 
                           id="loginPassword"
                           placeholder="Password" 
                           class="form-input" 
                           required>
                </div>
                
                <button type="submit" class="form-btn">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
            </form>
            
            <div style="text-align: center; margin-top: 1.5rem; color: var(--text-gray);">
                Don't have an account? 
                <a href="#" onclick="showSignup()" style="color: var(--primary-purple); text-decoration: none; font-weight: 600;">
                    Sign up here
                </a>
            </div>
            
            <div style="text-align: center; margin-top: 1rem; color: var(--text-gray); font-size: 0.9rem;">
                <a href="forgot-password.html" style="color: var(--primary-blue); text-decoration: none;">
                    <i class="fas fa-key"></i> Forgot password?
                </a>
            </div>
        </div>

        <!-- Signup Form (Hidden by default) -->
        <div class="form-container" id="signupForm" style="display: none;">
            <h2 style="text-align: center; font-family: 'Orbitron', sans-serif; margin-bottom: 2rem;">
                <i class="fas fa-user-plus"></i> Create Account
            </h2>
            
            <form id="registerForm" onsubmit="handleSignup(event)">
                <div class="form-group">
                    <input type="text" 
                           id="registerUsername"
                           placeholder="Username" 
                           class="form-input" 
                           required
                           minlength="3"
                           maxlength="20">
                </div>
                
                <div class="form-group">
                    <input type="email" 
                           id="registerEmail"
                           placeholder="Email" 
                           class="form-input" 
                           required>
                </div>
                
                <div class="form-group">
                    <input type="password" 
                           id="registerPassword"
                           placeholder="Password" 
                           class="form-input" 
                           required
                           minlength="6">
                </div>
                
                <div class="form-group">
                    <input type="password" 
                           id="registerConfirmPassword"
                           placeholder="Confirm Password" 
                           class="form-input" 
                           required>
                </div>
                
                <button type="submit" class="form-btn">
                    <i class="fas fa-user-plus"></i> Sign Up
                </button>
            </form>
            
            <div style="text-align: center; margin-top: 1.5rem; color: var(--text-gray);">
                Already have an account? 
                <a href="#" onclick="showLogin()" style="color: var(--primary-purple); text-decoration: none; font-weight: 600;">
                    Login here
                </a>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p style="color: var(--text-gray); margin-bottom: 1rem;">
            &copy; 2024 GamesArc.xyz - All rights reserved
        </p>
    </footer>

    <!-- Notification Container -->
    <div id="notification-container"></div>

   <script>
    // Clear any duplicate GamesArcDB
    delete window.GamesArcDB;
    delete window.auth;
    
    // Force reload clean versions
    localStorage.removeItem('gamesarc_users');
    localStorage.removeItem('gamesarc_sessions');
    console.log('Cleared previous auth data');
</script>
    <script>
        // Initialize auth system
        const auth = new AuthSystem();
        
        // Track page view
        document.addEventListener('DOMContentLoaded', function() {
            GamesArcDB.trackPageView(window.location.pathname);
            const stats = GamesArcDB.getStats();
            console.log('GamesArc Stats:', stats);
        });
        
        function showSignup() {
            document.getElementById('loginForm').parentElement.style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
        }
        
        function showLogin() {
            document.getElementById('loginForm').parentElement.style.display = 'block';
            document.getElementById('signupForm').style.display = 'none';
        }
        
        async function handleLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const success = await auth.login(email, password);
            if (success) {
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 1000);
            }
        }
        
        async function handleLogin(event) {
    event.preventDefault();
    
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    
    const success = await auth.login(email, password);
    if (success) {
        // ðŸ”´ ADD THIS LINE - Force UI update
        auth.updateUI();
        
        setTimeout(() => {
            window.location.href = 'index.html';
        }, 1000);
    }
}
        
        // Auto-login if already authenticated
        document.addEventListener('DOMContentLoaded', () => {
            const user = GamesArcDB.getCurrentUser();
            if (user) {
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 500);
            }
        });
    </script>
    <header>
    <nav>
        <div class="logo">
            <a href="index.html">GamesArc</a>
        </div>
        <div class="nav-links">
            <a href="games.html">Games</a>
            <a href="all-pc-games.html">PC Games</a>
            <a href="membership.html">Membership</a>
            <a href="contact.html">Contact</a>
        </div>
        <div class="nav-auth">
            <a href="login.html" id="loginBtn" class="btn btn-outline">Login</a>
            <div class="user-menu" id="profileBtn" style="display: none;">
                <button class="btn">
                    <span>Profile</span>
                </button>
                <div class="dropdown-content" id="userMenu"></div>
            </div>
        </div>
    </nav>
</header>
</body>
</html>