<script>
    // Game Modal System
    function showGameModal(gameId) {
        const games = {
            'gta-v': {
                title: 'Grand Theft Auto V',
                description: 'The biggest, most dynamic and most diverse open world ever created.',
                size: '95 GB',
                requirements: 'Windows 10, Intel i5, 8GB RAM, GTX 1060',
                downloads: '95.2M',
                rating: '4.9/5'
            },
            'elden-ring': {
                title: 'Elden Ring',
                description: 'Rise, Tarnished, and be guided by grace to become an Elden Lord.',
                size: '60 GB',
                requirements: 'Windows 10, Intel i5, 12GB RAM, GTX 1060',
                downloads: '20.4M',
                rating: '4.8/5'
            },
            'sekiro': {
                title: 'Sekiro: Shadows Die Twice',
                description: 'Carve your own clever path to vengeance in this award-winning adventure.',
                size: '25 GB',
                requirements: 'Windows 7, Intel i3, 4GB RAM, GTX 760',
                downloads: '10.1M',
                rating: '4.7/5'
            }
        }
        
        const game = games[gameId]
        
        const modalHTML = `
            <div class="modal" id="gameModal" style="display: flex;">
                <div class="modal-content" style="max-width: 600px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <h2 style="font-family: 'Orbitron', sans-serif; color: #8B5CF6;">
                            <i class="fas fa-gamepad"></i> ${game.title}
                        </h2>
                        <button onclick="closeGameModal()" style="background: none; border: none; color: #94A3B8; font-size: 1.5rem; cursor: pointer;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div style="margin-bottom: 1.5rem;">
                        <p style="color: #94A3B8; line-height: 1.6;">${game.description}</p>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0;">
                        <div style="background: rgba(139, 92, 246, 0.1); padding: 1rem; border-radius: 10px;">
                            <div style="color: #8B5CF6; font-weight: bold; margin-bottom: 0.5rem;">
                                <i class="fas fa-hdd"></i> File Size
                            </div>
                            <div style="color: #94A3B8;">${game.size}</div>
                        </div>
                        
                        <div style="background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 10px;">
                            <div style="color: #3B82F6; font-weight: bold; margin-bottom: 0.5rem;">
                                <i class="fas fa-star"></i> Rating
                            </div>
                            <div style="color: #94A3B8;">${game.rating}</div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(30, 41, 59, 0.7); padding: 1rem; border-radius: 10px; margin: 1.5rem 0;">
                        <div style="color: #8B5CF6; font-weight: bold; margin-bottom: 0.5rem;">
                            <i class="fas fa-desktop"></i> System Requirements
                        </div>
                        <div style="color: #94A3B8; font-size: 0.9rem;">${game.requirements}</div>
                    </div>
                    
                    <div style="margin: 1.5rem 0;">
                        <h3 style="color: var(--text-light); margin-bottom: 1rem;">
                            <i class="fas fa-download"></i> Download Options
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr; gap: 0.75rem;">
                            <button class="cloud-btn" onclick="startDownload('${gameId}', 'akirabox')" 
                                    style="background: linear-gradient(45deg, #8B5CF6, #3B82F6);">
                                <i class="fas fa-cloud"></i> Download via Akirabox
                            </button>
                            
                            <button class="cloud-btn" onclick="startDownload('${gameId}', 'mediafire')"
                                    style="background: linear-gradient(45deg, #3B82F6, #1E40AF);">
                                <i class="fas fa-fire"></i> Download via MediaFire
                            </button>
                            
                            <button class="cloud-btn" onclick="startDownload('${gameId}', 'yourcloud')"
                                    style="background: linear-gradient(45deg, #10B981, #059669);">
                                <i class="fas fa-server"></i> Download via Your Cloud
                            </button>
                        </div>
                    </div>
                    
                    <div style="padding: 1rem; background: rgba(15, 23, 42, 0.5); border-radius: 10px; margin-top: 1.5rem;">
                        <p style="color: #94A3B8; font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-shield-alt"></i> All downloads are virus-scanned and verified.
                        </p>
                    </div>
                </div>
            </div>
        `
        
        // Remove existing modal if any
        const existingModal = document.getElementById('gameModal')
        if (existingModal) {
            existingModal.remove()
        }
        
        // Add new modal
        const modalContainer = document.createElement('div')
        modalContainer.innerHTML = modalHTML
        document.body.appendChild(modalContainer)
        
        // Add modal styles if not already present
        if (!document.querySelector('#modalStyles')) {
            const modalStyles = `
                <style>
                    .modal {
                        position: fixed;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(15, 23, 42, 0.95);
                        backdrop-filter: blur(10px);
                        z-index: 1000;
                        align-items: center;
                        justify-content: center;
                        display: none;
                    }
                    
                    .modal-content {
                        background: rgba(30, 41, 59, 0.95);
                        border-radius: 20px;
                        padding: 2rem;
                        border: 2px solid rgba(139, 92, 246, 0.3);
                        max-width: 90%;
                        animation: modalSlide 0.3s ease;
                    }
                    
                    @keyframes modalSlide {
                        from {
                            opacity: 0;
                            transform: translateY(-20px);
                        }
                        to {
                            opacity: 1;
                            transform: translateY(0);
                        }
                    }
                    
                    .cloud-btn {
                        color: white;
                        border: none;
                        padding: 1rem;
                        border-radius: 10px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 0.5rem;
                    }
                    
                    .cloud-btn:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 10px 20px rgba(139, 92, 246, 0.3);
                    }
                </style>
            `
            const styleElement = document.createElement('div')
            styleElement.id = 'modalStyles'
            styleElement.innerHTML = modalStyles
            document.head.appendChild(styleElement)
        }
    }
    
    function closeGameModal() {
        const modal = document.getElementById('gameModal')
        if (modal) {
            modal.remove()
        }
    }
    
    function startDownload(gameId, provider) {
        // Track download
        if (window.GamesArcDB) {
            const userId = localStorage.getItem('gamesarc_user_id') || 'anonymous'
            GamesArcDB.trackDownload(gameId, userId)
        }
        
        let url = '#'
        let message = ''
        
        switch(provider) {
            case 'akirabox':
                url = 'https://akirabox.com/'
                message = 'Redirecting to Akirabox...'
                break
                
            case 'mediafire':
                url = 'https://mediafire.com/'
                message = 'Redirecting to MediaFire...'
                break
                
            case 'yourcloud':
                url = 'YOUR_CLOUD_STORAGE_LINK_HERE' // ⚠️ REPLACE THIS
                message = 'Redirecting to your cloud storage...'
                alert('⚠️ Please update the cloud link in the code!')
                break
        }
        
        if (url !== '#') {
            if (confirm(`${message}\n\nDownload will start in a new tab. Continue?`)) {
                window.open(url, '_blank')
                closeGameModal()
                
                // Show success message
                alert('✅ Download started! Check your downloads folder.')
            }
        }
    }
    
    // Close modal when clicking outside
    document.addEventListener('click', function(event) {
        if (event.target.classList.contains('modal')) {
            closeGameModal()
        }
    })
    
    // Close with Escape key
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeGameModal()
        }
    })
</script>